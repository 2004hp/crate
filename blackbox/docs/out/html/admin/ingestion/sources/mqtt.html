<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>MQTT Ingestion Source &mdash; CrateDB  documentation</title>
    
    <link rel="stylesheet" href="../../../_static/basic.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/normalize.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/bootstrap.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/mmenu.all.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/components.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/crateio.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/crateio-rtd.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css?ver=1.1" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!--[if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif]-->
    <script type="text/javascript" src="https://cdn.crate.io/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/modernizr.js?ver=1.1"></script>
    <script type="text/javascript" src="../../../_static/js/underscore.min.js?ver=1.1"></script>
    <script type="text/javascript" src="../../../_static/doctools.js?ver=1.1"></script>
    <script type="text/javascript" src="../../../_static/js/searchtools.js?ver=1.1"></script>
    <script type="text/javascript" src="../../../_static/js/webflow.js?ver=1.1"></script>
    <script type="text/javascript" src="../../../_static/js/bootstrap.js?ver=1.1"></script>
    <script type="text/javascript" src="../../../_static/js/mmenu.all.min.js?ver=1.1"></script>
    <script type="text/javascript" src="../../../_static/js/fontawesome.js?ver=1.1"></script>
    <script type="text/javascript" src="../../../_static/js/custom.js?ver=1.1"></script>
    <link rel="top" title="CrateDB  documentation" href="../../../index.html" />
    <link rel="up" title="Ingestion Sources" href="index.html" />
    <link rel="next" title="Ingestion Rules" href="../rules.html" />
    <link rel="prev" title="Ingestion Sources" href="index.html" />
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
  <meta name="apple-mobile-web-app-capable" content="yes">
  
  </head>
  <body>
  <header class="header-nav">
  <div class="container">
    <div class="navbar w-nav" data-animation="default" data-collapse="small" data-contain="1" data-duration="400">
      <a class="brand w-nav-brand" href="https://crate.io">
        <img src="../../../_static/images/logo-crate.png" width="217">
      </a>
      <nav class="w-nav-menu main-nav" role="navigation">
        <div class="dropdownBackground">
          <span class="arrow"></span>
        </div>
        <ul id="menu-top-navigation" class="menu">
          <li class="navlink w-nav-link menu-item"><a href="https://crate.io/overview/">CrateDB</a></li>
          <li class="navlink w-nav-link menu-item menu-item-has-children"><a href="https://crate.io/cratedb-solutions/">Use Cases</a>
            <ul class="sub-menu">
              <li class="menu-item"><a href="https://crate.io/customers/">Customers</a></li>
              <li class="menu-item"><a href="https://crate.io/iot-sensor-solutions/">IoT &amp; Sensor Data</a></li>
              <li class="menu-item"><a href="https://crate.io/geospatial-analytics/">Geospatial Analytics</a></li>
              <li class="menu-item"><a href="https://crate.io/cyber-security/">Cyber Security</a></li>
              <li class="menu-item"><a href="https://crate.io/time-series/">Time Series</a></li>
            </ul>
          </li>
          <li class="navlink w-nav-link menu-item"><a href="https://crate.io/pricing/">Pricing</a></li>
          <li class="navlink w-nav-link menu-item menu-item-has-children"><a>Resources</a>
            <ul class="sub-menu">
              <li class="menu-item"><a href="https://crate.io/docs/">Documentation</a></li>
              <li class="menu-item"><a href="https://crate.io/resources/">Resource Library</a></li>
              <li class="menu-item"><a href="https://crate.io/blog/">Blog</a></li>
              <li class="menu-item"><a href="https://crate.io/community/">Community</a></li>
            </ul>
          </li>
          <li class="btn-link w-nav-link menu-item"><a href="https://crate.io/download/">Download</a></li>
        </ul>
      </nav>

      <div id="mobile-nav" class="mm-menu">
        <ul class="offcanvas-menu">
          <li class="navlink w-nav-link menu-item"><a href="https://crate.io/overview/">CrateDB</a></li>
          <li class="navlink w-nav-link menu-item menu-item-has-children"><a href="https://crate.io/cratedb-solutions/">Use Cases</a>
            <ul class="sub-menu">
              <li class="menu-item"><a href="https://crate.io/customers/">Customers</a></li>
              <li class="menu-item"><a href="https://crate.io/iot-sensor-solutions/">IoT &amp; Sensor Data</a></li>
              <li class="menu-item"><a href="https://crate.io/geospatial-analytics/">Geospatial Analytics</a></li>
              <li class="menu-item"><a href="https://crate.io/cyber-security/">Cyber Security</a></li>
              <li class="menu-item"><a href="https://crate.io/time-series/">Time Series</a></li>
            </ul>
          </li>
          <li class="navlink w-nav-link menu-item"><a href="https://crate.io/pricing/">Pricing</a></li>
          <li class="navlink w-nav-link menu-item menu-item-has-children"><a>Resources</a>
            <ul class="sub-menu">
              <li class="menu-item"><a href="https://crate.io/docs/">Documentation</a></li>
              <li class="menu-item"><a href="https://crate.io/resources/">Resource Library</a></li>
              <li class="menu-item"><a href="https://crate.io/blog/">Blog</a></li>
              <li class="menu-item"><a href="https://crate.io/community/">Community</a></li>
            </ul>
          </li>
          <li class="btn-link w-nav-link menu-item"><a href="https://crate.io/download/">Download</a></li>
        </ul>
      </div>

      <a href="#mobile-nav" class="fa fa-bars mobile-nav-button"></a>
    </div>
  </div>
</header>

  <div class="w-section section border-top">
    <div class="w-container w-hidden-main margin-bottom-32">
      <div class="section" style="margin: 0px">
        <a href="#" id="mobile-menu-toggler" class="w-button">Toggle Doc Menu</a>
      </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="col-md-4 col-lg-3">
          <aside class="wrapper-navleft"><div role="complementary" class="bs-docs-sidebar hidden-print" id="nav-affix">
  <div class="search-link">
    <a href="../../../search.html" class="btn btn-primary">Search Documentation</a>
  </div>
  <ul class="bs-docs-sidenav bs-sidenav nav" role="complementary">

    

    
      <ul class="toctree nav nav-list">
  <li class="navleft-item">CrateDB</li>
  <ul>
    
    <li class="navleft-item"><a href="/docs/crate/getting-started/">Getting Started</a></li>
    
    
    <li class="current">
      <a class="current-active" href="../../../index.html" title="CrateDB">Reference</a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../run.html">Running CrateDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../run.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../run.html#command-line-options">Command Line Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../run.html#signal-handling">Signal Handling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../config/index.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../config/node.html">Node Specific Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#basics">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#node-types">Node Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#read-only-node">Read-only node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#hosts">Hosts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#ports">Ports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#paths">Paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#plugins">Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#memory">Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#garbage-collection">Garbage Collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#elasticsearch-http-rest-api">Elasticsearch HTTP REST API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#cross-origin-resource-sharing-cors">Cross-Origin Resource Sharing (CORS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#blobs">Blobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#repositories">Repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#queries">Queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/node.html#custom-attributes">Custom Attributes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../config/cluster.html">Cluster Wide Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#non-runtime-cluster-wide-settings">Non-Runtime Cluster Wide Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#collecting-stats">Collecting Stats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#usage-data-collector">Usage Data Collector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#graceful-stop">Graceful Stop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#bulk-operations">Bulk Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#discovery">Discovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#routing-allocation">Routing Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#recovery">Recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#store-level-throttling">Store Level Throttling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#query-circuit-breaker">Query Circuit Breaker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#field-data-circuit-breaker">Field Data Circuit Breaker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#request-circuit-breaker">Request Circuit Breaker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#thread-pools">Thread Pools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/cluster.html#metadata">Metadata</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../config/session.html">Session Setting Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../config/logging.html">Logging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../config/logging.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/logging.html#settings">Settings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../config/environment.html">Environment Variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../config/environment.html#crate-home"><code class="docutils literal"><span class="pre">CRATE_HOME</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/environment.html#crate-java-opts"><code class="docutils literal"><span class="pre">CRATE_JAVA_OPTS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/environment.html#crate-heap-size"><code class="docutils literal"><span class="pre">CRATE_HEAP_SIZE</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../config/system.html">Operating System Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../config/system.html#virtual-memory">Virtual Memory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../config/enterprise.html">Enterprise Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../config/enterprise.html#enterprise-license">Enterprise License</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/enterprise.html#javascript-language">Javascript Language</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/enterprise.html#authentication">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../config/enterprise.html#secured-communications-ssl-tls">Secured Communications (SSL/TLS)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../general/index.html">General Use</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../general/ddl/index.html">Data Definition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/create-table.html">Creating Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/data-types.html">Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/system-columns.html">System Columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/generated-columns.html">Generated Columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/constraints.html">Constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/storage.html">Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/partitioned-tables.html">Partitioned Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/sharding.html">Sharding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/replication.html">Replication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/column-policy.html">Column Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/fulltext-indices.html">Fulltext Indices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/analyzers.html">Fulltext Analyzers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/show-create-table.html">Show Create Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/ddl/alter-table.html">Altering Tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/dml.html">Data Manipulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../general/dml.html#inserting-data">Inserting Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/dml.html#updating-data">Updating Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/dml.html#deleting-data">Deleting Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/dml.html#import-and-export">Import and Export</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/dql/index.html">Querying Crate</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../general/dql/selects.html">Selecting Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/dql/joins.html">Joins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/dql/union.html">Union All</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/dql/refresh.html">Refresh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/dql/fulltext.html">Fulltext Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/dql/geo.html">Geo Search</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/builtins/index.html">Built-in Functions and Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../general/builtins/scalar.html">Scalar Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/builtins/aggregation.html">Aggregation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/builtins/arithmetic.html">Arithmetic Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/builtins/table-functions.html">Table Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/builtins/operators.html">Comparison Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/builtins/array-comparisons.html">Array Comparisons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/builtins/subquery-expressions.html">Subquery Expressions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/user-defined-functions.html">User-Defined Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../general/user-defined-functions.html#create-or-replace"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">OR</span> <span class="pre">REPLACE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/user-defined-functions.html#supported-types">Supported Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/user-defined-functions.html#overloading">Overloading</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/user-defined-functions.html#determinism">Determinism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/user-defined-functions.html#drop-function"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">FUNCTION</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/user-defined-functions.html#supported-languages">Supported Languages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/blobs.html">Blobs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../general/blobs.html#creating-a-table-for-blobs">Creating a Table for Blobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/blobs.html#custom-location-for-storing-blob-data">Custom Location for Storing Blob Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/blobs.html#list">List</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/blobs.html#altering-a-blob-table">Altering a Blob Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/blobs.html#deleting-a-blob-table">Deleting a Blob Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/blobs.html#using-blob-tables">Using Blob Tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/occ.html">Optimistic Concurrency Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../general/occ.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/occ.html#optimistic-update">Optimistic Update</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/occ.html#optimistic-delete">Optimistic Delete</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/occ.html#known-limitations">Known Limitations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../general/information-schema.html">Information Schema</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../general/information-schema.html#access">Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../general/information-schema.html#virtual-tables">Virtual Tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Administration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../system-information.html">System Information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../system-information.html#cluster">Cluster</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../system-information.html#nodes">Nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../system-information.html#node-checks">Node Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../system-information.html#shards">Shards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../system-information.html#jobs-operations-and-logs">Jobs, Operations, and Logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../system-information.html#cluster-checks">Cluster Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../system-information.html#repositories">Repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../system-information.html#snapshots">Snapshots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../system-information.html#summits">Summits</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../system-information.html#users">Users</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../system-information.html#allocations">Allocations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../system-information.html#shard-table-permissions">Shard Table Permissions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../runtime-config.html">Runtime Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user-management.html">User Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user-management.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user-management.html#create-user"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">USER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user-management.html#alter-user"><code class="docutils literal"><span class="pre">ALTER</span> <span class="pre">USER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user-management.html#drop-user"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">USER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user-management.html#list-users">List Users</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../privileges.html">Privileges</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../privileges.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../privileges.html#privilege-types">Privilege Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../privileges.html#hierarchical-inheritance-of-privileges">Hierarchical Inheritance of Privileges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../privileges.html#behavior-of-grant-deny-and-revoke">Behavior of <code class="docutils literal"><span class="pre">GRANT</span></code>, <code class="docutils literal"><span class="pre">DENY</span></code> and <code class="docutils literal"><span class="pre">REVOKE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../privileges.html#list-privileges">List Privileges</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../auth/index.html">Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../auth/methods.html">Authentication Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../auth/hba.html">Host Based Authentication (HBA)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../ssl.html">Secured Communications (SSL/TLS)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../ssl.html#ssl-tls-configuration">SSL/TLS Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ssl.html#setting-up-a-keystore-truststore-with-a-certificate-chain">Setting up a Keystore/Truststore With a Certificate Chain</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Ingestion Framework</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Ingestion Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rules.html">Ingestion Rules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../optimization.html">Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../optimization.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../optimization.html#multiple-table-optimization">Multiple Table Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../optimization.html#partition-optimization">Partition Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../optimization.html#segments-upgrade">Segments Upgrade</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../jobs-management.html">Jobs Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../monitoring.html">JMX Monitoring</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../monitoring.html#setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../monitoring.html#using-docker">Using Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../monitoring.html#jmx-beans">JMX Beans</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../snapshots.html">Snapshots</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../snapshots.html#snapshot">Snapshot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../snapshots.html#restore">Restore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../snapshots.html#cleanup">Cleanup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../snapshots.html#requirements-for-using-hdfs-repositories">Requirements for Using HDFS Repositories</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../discovery.html">Cloud Discovery</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../discovery.html#amazon-ec2-discovery">Amazon EC2 Discovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../discovery.html#microsoft-azure-discovery">Microsoft Azure Discovery</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../udc.html">Usage Data Collector</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../udc.html#technical-information">Technical Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../udc.html#admin-ui-tracking">Admin UI Tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../udc.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../udc.html#how-to-disable-udc">How to Disable UDC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../sql/index.html">SQL Syntax</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../sql/general/index.html">General SQL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/general/constraints.html">Constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/general/value-expressions.html">Value Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/general/lexical-structure.html">Lexical Structure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../sql/statements/index.html">SQL Statements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/alter-cluster.html"><code class="docutils literal"><span class="pre">ALTER</span> <span class="pre">CLUSTER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/alter-table.html"><code class="docutils literal"><span class="pre">ALTER</span> <span class="pre">TABLE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/alter-user.html"><code class="docutils literal"><span class="pre">ALTER</span> <span class="pre">USER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/copy-from.html"><code class="docutils literal"><span class="pre">COPY</span> <span class="pre">FROM</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/copy-to.html"><code class="docutils literal"><span class="pre">COPY</span> <span class="pre">TO</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/create-analyzer.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">ANALYZER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/create-blob-table.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">BLOB</span> <span class="pre">TABLE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/create-function.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">FUNCTION</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/create-ingest-rule.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">INGEST</span> <span class="pre">RULE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/create-repository.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">REPOSITORY</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/create-snapshot.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">SNAPSHOT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/create-table.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/create-user.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">USER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/delete.html"><code class="docutils literal"><span class="pre">DELETE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/deny.html"><code class="docutils literal"><span class="pre">DENY</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/drop-function.html"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">FUNCTION</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/drop-ingest-rule.html"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">INGEST</span> <span class="pre">RULE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/drop-repository.html"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">REPOSITORY</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/drop-snapshot.html"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">SNAPSHOT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/drop-table.html"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">TABLE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/drop-user.html"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">USER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/explain.html"><code class="docutils literal"><span class="pre">EXPLAIN</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/grant.html"><code class="docutils literal"><span class="pre">GRANT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/insert.html"><code class="docutils literal"><span class="pre">INSERT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/kill.html"><code class="docutils literal"><span class="pre">KILL</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/optimize.html"><code class="docutils literal"><span class="pre">OPTIMIZE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/refresh.html"><code class="docutils literal"><span class="pre">REFRESH</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/restore-snapshot.html"><code class="docutils literal"><span class="pre">RESTORE</span> <span class="pre">SNAPSHOT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/revoke.html"><code class="docutils literal"><span class="pre">REVOKE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/select.html"><code class="docutils literal"><span class="pre">SELECT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/set.html"><code class="docutils literal"><span class="pre">SET</span></code> and <code class="docutils literal"><span class="pre">RESET</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/set-transaction.html"><code class="docutils literal"><span class="pre">SET</span> <span class="pre">TRANSACTION</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/show-columns.html"><code class="docutils literal"><span class="pre">SHOW</span> <span class="pre">COLUMNS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/show-create-table.html"><code class="docutils literal"><span class="pre">SHOW</span> <span class="pre">CREATE</span> <span class="pre">TABLE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/show-schemas.html"><code class="docutils literal"><span class="pre">SHOW</span> <span class="pre">SCHEMAS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/show-tables.html"><code class="docutils literal"><span class="pre">SHOW</span> <span class="pre">TABLES</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../sql/statements/update.html"><code class="docutils literal"><span class="pre">UPDATE</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../interfaces/index.html">Client Interfaces</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../interfaces/http.html">HTTP Endpoint</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../interfaces/http.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../interfaces/http.html#parameter-substitution">Parameter Substitution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../interfaces/http.html#default-schema">Default Schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../interfaces/http.html#column-types">Column Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../interfaces/http.html#bulk-operations">Bulk Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../interfaces/http.html#error-handling">Error Handling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../interfaces/postgres.html">PostgreSQL Wire Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../interfaces/postgres.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../interfaces/postgres.html#server-compatibility-and-implementation-status">Server Compatibility and Implementation Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../interfaces/postgres.html#client-compatibility">Client Compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../interfaces/postgres.html#implementation-differences">Implementation Differences</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../enterprise/index.html">Enterprise Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendices/index.html">Appendices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../appendices/release-notes/index.html">Release Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../appendices/release-notes/index.html#x">2.x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../appendices/release-notes/index.html#id6">1.x</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../appendices/sql-compliance.html">Standard SQL Compliance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../appendices/sql-compliance.html#data-types">Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../appendices/sql-compliance.html#create-table">Create Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../appendices/sql-compliance.html#alter-table">Alter Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../appendices/sql-compliance.html#insert-update-and-delete">Insert, Update, and Delete</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../appendices/sql-compliance.html#system-information-tables">System Information Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../appendices/sql-compliance.html#blob-support">BLOB Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../appendices/sql-compliance.html#transactions-begin-commit-and-rollback">Transactions (<code class="docutils literal"><span class="pre">BEGIN</span></code>, <code class="docutils literal"><span class="pre">COMMIT</span></code>, and <code class="docutils literal"><span class="pre">ROLLBACK</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../appendices/sql-compliance.html#unsupported-features-and-functions">Unsupported Features and Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../appendices/supported-features.html">Supported Features</a></li>
</ul>
</li>
</ul>

    </li>
    
    
    <li class="navleft-item"><a href="/docs/crate/guide">Guide</a></li>
    
  </ul>
  <li class="navleft-item">CrateDB Clients</li>
  <ul>
    
    <li class="navleft-item"><a href="/docs/clients/crash">The CrateDB Shell</a></li>
    
    
    <li class="navleft-item"><a href="/docs/clients/python">Python</a></li>
    
    
    <li class="navleft-item"><a href="/docs/clients/jdbc">JDBC</a></li>
    
    
    <li class="navleft-item"><a href="/docs/clients/dbal">PHP DBAL</a></li>
    
    
    <li class="navleft-item"><a href="/docs/clients/pdo">PHP PDO</a></li>
    
  </ul>

  <li class="navleft-item border-top"><a href="https://github.com/crate/crate-sample-apps">Sample Applications</a></li>
  <li class="navleft-item"><a href="/docs/support/">Support</a></li>
</ul>
    

    
      
      
    

    
    

    
      <li></li>
    

  </ul>
</div>
            
          </aside>
        </div>
        <div class="col-md-8 col-lg-9">
          <div class="wrapper-content-right">
            
  <div class="section" id="mqtt-ingestion-source">
<span id="ingest-mqtt"></span><h1>MQTT Ingestion Source<a class="headerlink" href="#mqtt-ingestion-source" title="Permalink to this headline">¶</a></h1>
<div class="sidebar">
<p class="first sidebar-title">Overview</p>
<div class="last figure">
<img alt="A diagram of CrateDB acting as an MQTT endpoint" src="../../../_images/mqtt-01.png" />
</div>
</div>
<p><a class="reference external" href="http://mqtt.org/">MQTT</a> (Message Queue Telemetry Transport) is a machine-to-machine communication
protocol particularly well suited for machine data and Internet of Things (IoT)
applications.</p>
<p>The MQTT ingestion source allows CrateDB to function as an MQTT endpoint for
data ingestion. Incoming messages can be written to user defined tables
according to <a class="reference internal" href="../rules.html#administration-ingestion-rules"><span class="std std-ref">user defined rules</span></a>. These
tables can then be queried or polled at will by CrateDB clients.</p>
<p>Using CrateDB as an MQTT endpoint removes the need for intermediary brokers,
message queues, or MQTT subscribers doing message transformation or
persistence.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The MQTT ingestion source an
<a class="reference internal" href="../../../enterprise/index.html#enterprise-features"><span class="std std-ref">enterprise feature</span></a>.</p>
</div>
<p class="rubric">Table of Contents</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#configuration" id="id1">Configuration</a><ul>
<li><a class="reference internal" href="#node-settings" id="id2">Node Settings</a><ul>
<li><a class="reference internal" href="#ssl-support" id="id3">SSL Support</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#usage" id="id4">Usage</a><ul>
<li><a class="reference internal" href="#quality-of-service" id="id5">Quality of Service</a></li>
<li><a class="reference internal" href="#data-ingestion" id="id6">Data Ingestion</a><ul>
<li><a class="reference internal" href="#mqtt-data-structure" id="id7">MQTT Data Structure</a></li>
<li><a class="reference internal" href="#example" id="id8">Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="configuration">
<span id="ingest-mqtt-config"></span><h2><a class="toc-backref" href="#id1">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>This ingestion source adds a few additional settings that you can configure.</p>
<p>These node settings can be <a class="reference internal" href="../../../config/index.html#config"><span class="std std-ref">configured like usual</span></a>, via the
<code class="docutils literal"><span class="pre">crate.yml</span></code> configuration file or as command line parameters using the <code class="docutils literal"><span class="pre">-C</span></code>
option.</p>
<div class="section" id="node-settings">
<h3><a class="toc-backref" href="#id2">Node Settings</a><a class="headerlink" href="#node-settings" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Node settings only affect the node they are configured on.</p>
</div>
<dl class="docutils">
<dt><strong>ingestion.mqtt.enabled</strong></dt>
<dd><div class="first line-block">
<div class="line"><em>Default:</em>   <code class="docutils literal"><span class="pre">false</span></code></div>
<div class="line"><em>Runtime:</em>  <code class="docutils literal"><span class="pre">no</span></code></div>
</div>
<p class="last">Enables the <a class="reference external" href="http://mqtt.org/">MQTT</a> ingestion source on this node.</p>
</dd>
</dl>
<dl class="docutils" id="ingestion-mqtt-port">
<dt><strong>ingestion.mqtt.port</strong></dt>
<dd><div class="first line-block">
<div class="line"><em>Default:</em>   <code class="docutils literal"><span class="pre">1883</span></code></div>
<div class="line"><em>Runtime:</em>  <code class="docutils literal"><span class="pre">no</span></code></div>
</div>
<p>TCP port on which the endpoint is exposed.</p>
<p class="last">Can either be a number, or a string defining a port range. The first free
port of this range is used.</p>
</dd>
<dt><strong>ingestion.mqtt.timeout</strong></dt>
<dd><div class="first line-block">
<div class="line"><em>Default:</em>   <code class="docutils literal"><span class="pre">10s</span></code></div>
<div class="line"><em>Runtime:</em>  <code class="docutils literal"><span class="pre">no</span></code></div>
</div>
<p>The default keep-alive timeout for establised connections.</p>
<p class="last">This timeout is used if the client does not specify a <code class="docutils literal"><span class="pre">keepAlive</span></code> option
when sending the <code class="docutils literal"><span class="pre">CONNECT</span></code> message.</p>
</dd>
</dl>
<div class="section" id="ssl-support">
<h4><a class="toc-backref" href="#id3">SSL Support</a><a class="headerlink" href="#ssl-support" title="Permalink to this headline">¶</a></h4>
<p>SSL support is available for the MQTT connections and can be enabled using the
<code class="docutils literal"><span class="pre">ssl.ingestion.mqtt.enabled</span></code> setting. When SSL is enabled for the MQTT
connection, consider changing <code class="docutils literal"><span class="pre">ingestion.mqtt.port</span></code> to <code class="docutils literal"><span class="pre">8883</span></code> which is
the TCP/IP registered port for MQTT over SSL.</p>
<p>Once CrateDB is configured to use encrypted MQTT connections, unencrypted
connections will not be supported anymore.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../../ssl.html#admin-ssl"><span class="std std-ref">Secured Communications (SSL/TLS)</span></a></p>
</div>
</div>
</div>
</div>
<div class="section" id="usage">
<span id="ingest-mqtt-usage"></span><h2><a class="toc-backref" href="#id4">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="quality-of-service">
<h3><a class="toc-backref" href="#id5">Quality of Service</a><a class="headerlink" href="#quality-of-service" title="Permalink to this headline">¶</a></h3>
<p>This ingestion source only implements MQTT Quality of Service (QoS) <a class="reference external" href="http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Toc398718101">level
one</a>, meaning that messages will be delivered at least once to the endpoint
and stored in the database.</p>
<p>Other QoS levels are not supported and messages sent with those levels are
discared and an error is logged.</p>
</div>
<div class="section" id="data-ingestion">
<h3><a class="toc-backref" href="#id6">Data Ingestion</a><a class="headerlink" href="#data-ingestion" title="Permalink to this headline">¶</a></h3>
<p>The ingestion of data is controlled with <a class="reference internal" href="../rules.html#administration-ingestion-rules"><span class="std std-ref">Ingestion Rules</span></a>.</p>
<p>Without any defined valid rule, no data will be ingested at all and messages
will not be acknowledged. The <code class="docutils literal"><span class="pre">PUBLISH</span></code> messages will receive the
corresponding <code class="docutils literal"><span class="pre">PUBACK</span></code> reply only after the message is stored in all matching
ingest rules target tables (as there can be multiple ingestion rules configured
for this source). If at least one matching ingestion rule fails to store the
incoming message, the client will not receive any reply and will have to resend
the request message.
Ingest rules execution failures will usually be temporary (eg. a mismatch
between a rule target table schema and ingestion source payload structure) and
the administrator will have the opportunity to fix the rule execution between
message retransmissions (eg. alter the target table schema).</p>
<p>The <code class="docutils literal"><span class="pre">source_ident</span></code> of this implementation is: <code class="docutils literal"><span class="pre">mqtt</span></code></p>
<p>Rule conditions and the target table must match the <a class="reference internal" href="#mqtt-data-structure">MQTT data structure</a>.</p>
<p>The default user for the <code class="docutils literal"><span class="pre">INSERT</span></code> operations in the <code class="docutils literal"><span class="pre">target_table</span></code> is the
superuser <code class="docutils literal"><span class="pre">crate</span></code>.</p>
<div class="section" id="mqtt-data-structure">
<span id="ingest-mqtt-data-structure"></span><h4><a class="toc-backref" href="#id7">MQTT Data Structure</a><a class="headerlink" href="#mqtt-data-structure" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="16%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>client_id</td>
<td>STRING</td>
<td>ID of the client that sent the MQTT message.</td>
</tr>
<tr class="row-odd"><td>packet_id</td>
<td>STRING</td>
<td><code class="docutils literal"><span class="pre">packet_id</span></code> of the <code class="docutils literal"><span class="pre">PUBLISH</span></code> message.</td>
</tr>
<tr class="row-even"><td>topic</td>
<td>STRING</td>
<td><code class="docutils literal"><span class="pre">topic</span></code> of the <code class="docutils literal"><span class="pre">PUBLISH</span></code> message.</td>
</tr>
<tr class="row-odd"><td>ts</td>
<td>TIMESTAMP</td>
<td>Insert timestamp (<code class="docutils literal"><span class="pre">CURRENT_TIMESTAP</span></code>).</td>
</tr>
<tr class="row-even"><td>payload</td>
<td>OBJECT</td>
<td><code class="docutils literal"><span class="pre">payload</span></code> of the <code class="docutils literal"><span class="pre">PUBLISH</span></code> message.
<strong>Must be a valid JSON string!</strong></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="example">
<h4><a class="toc-backref" href="#id8">Example</a><a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h4>
<p>To start ingesting with the MQTT data ingestion source, first create a target
table matching the <a class="reference internal" href="#mqtt-data-structure">MQTT data structure</a>, like so:</p>
<div class="highlight-psql"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">mqtt_temperature</span> <span class="p">(</span>
<span class="mf">...</span>  <span class="s s-Name">&quot;client_id&quot;</span> <span class="n">STRING</span><span class="p">,</span>
<span class="mf">...</span>  <span class="s s-Name">&quot;packet_id&quot;</span> <span class="nb">INTEGER</span><span class="p">,</span>
<span class="mf">...</span>  <span class="s s-Name">&quot;topic&quot;</span> <span class="n">STRING</span><span class="p">,</span>
<span class="mf">...</span>  <span class="s s-Name">&quot;ts&quot;</span> <span class="nb">TIMESTAMP</span><span class="p">,</span>
<span class="mf">...</span>  <span class="s s-Name">&quot;payload&quot;</span> <span class="k">OBJECT</span><span class="p">(</span><span class="n">IGNORED</span><span class="p">),</span>
<span class="mf">...</span>  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="s s-Name">&quot;client_id&quot;</span><span class="p">,</span> <span class="s s-Name">&quot;packet_id&quot;</span><span class="p">)</span>
<span class="mf">...</span> <span class="p">)</span>
<span class="k">CREATE</span> <span class="n">OK</span><span class="p">,</span> <span class="mf">1</span> <span class="k">row</span> <span class="n">affected</span> <span class="p">(</span><span class="mf">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>The structure of this target table is very important, as it can prevent or
allow duplicates in case of message retransmission.</p>
<p>In this example, if a message is delivered multiple times, the message will
only be stored once in the <code class="docutils literal"><span class="pre">mqtt_temperature</span></code> table because the <code class="docutils literal"><span class="pre">PRIMARY</span>
<span class="pre">KEY</span></code> includes both the <code class="docutils literal"><span class="pre">client_id</span></code> and <code class="docutils literal"><span class="pre">packet_id</span></code>. If the <code class="docutils literal"><span class="pre">packet_id</span></code>
were to be omitted from the primary key, a message arriving at CrateDB multiple
times will be stored multiple times.</p>
<p>Once you have done that, you can create <a class="reference internal" href="../rules.html#administration-ingestion-rules"><span class="std std-ref">ingestion rules</span></a>, like so:</p>
<div class="highlight-psql"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="k">CREATE</span> <span class="n">INGEST</span> <span class="k">RULE</span> <span class="n">temperature</span> <span class="k">ON</span> <span class="n">mqtt</span>
<span class="mf">...</span>  <span class="k">WHERE</span> <span class="n">topic</span> <span class="k">like</span> <span class="s1">&#39;temperature/%&#39;</span>
<span class="mf">...</span>  <span class="k">INTO</span> <span class="n">mqtt_temperature</span><span class="p">;</span>
<span class="go">CREATE OK, 1 row affected (... sec)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="https://crate.io/a/getting-started-cratedb-mqtt-endpoint/">Getting Started With CrateDB as an MQTT Endpoint</a> (November
2017)</p>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
    </div>
  </div><footer class="footer">
  <div class="w-container">
    <div class="w-clearfix">
      <div class="w-row mobileAlign">
        <div class="w-col w-col-3 footer-menu">
          <p class="menu-Label">Product</p>
          <ul class="vertical-menu">
            <li class="footer-listitem-new"><a href="https://crate.io/overview/">Overview</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/download/">Download</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/use-cases/">Use Cases</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/customers/">Customers</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/pricing/">Pricing</a></li>
          </ul>
        </div>
        <div class="w-col w-col-3 footer-menu">
          <p class="menu-Label">Resources</p>
          <ul class="vertical-menu">
            <li class="footer-listitem-new"><a href="https://crate.io/resources/">Resource Library</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/docs/">Documentation</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/docs/support/">Support</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/events/">Events</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/blog/">Blog</a></li>
          </ul>
        </div>
        <div class="w-col w-col-3 footer-menu">
          <p class="menu-Label">Company</p>
          <ul class="vertical-menu">
            <li class="footer-listitem-new "><a href="https://crate.io/about/">About</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/jobs/">Jobs</a></li>
            <li class="footer-listitem-new "><a href="https://crate.io/partners/">Partners</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/in-the-news/">In the News</a></li>
          </ul>
        </div>
        <div class="w-col w-col-3">
          <ul class="footer-list w-list-unstyled" style="margin-top: 0; padding-left: 0;">
            <li class="footer-listitem">
              <a class="footer-link-connect w-inline-block" href="https://www.facebook.com/crate.io" target="_blank" style="padding-left: 0;">
                <img src="../../../_static/images/f-logo-facebook.png" width="12">
              </a>
            </li>
            <li class="footer-listitem">
              <a class="footer-link-connect w-inline-block" href="https://twitter.com/Crateio" target="_blank">
                <img src="../../../_static/images/f-logo-twitter.png" width="23">
              </a>
            </li>
            <li class="footer-listitem">
              <a class="footer-link-connect w-inline-block" href="https://plus.google.com/105753392254543335997" target="_blank">
                <img src="../../../_static/images/f-logo-google.png" width="23">
              </a>
            </li>
            <li class="footer-listitem">
              <a class="footer-link-connect w-inline-block" href="https://www.linkedin.com/company/crateio" target="_blank">
                <img src="../../../_static/images/f-logo-linkedin.png" width="22">
              </a>
            </li>
            <li class="footer-listitem">
              <a class="footer-link-connect w-inline-block" href="https://www.youtube.com/channel/UCcp_IqjXaejmwBcwg51n1AA" target="_blank">
                <img src="../../../_static/images/f-logo-youtube.png" width="24">
              </a>
            </li>
            <li class="footer-listitem">
              <a class="footer-link-connect w-inline-block" href="https://github.com/crate">
                <img src="../../../_static/images/f-logo-github.png" width="22">
              </a>
            </li>
            <div class="mobileHoriztonalMenu">
              <li class="footer-listitem-new"><a href="https://crate.io/contact/">Contact</a></li>
              <li class="footer-listitem-new"><a href="https://crate.io/legal/">Legal</a></li>
              <li class="footer-listitem-new"><a href="https://crate.io/legal/imprint/">Imprint</a></li>
            </div>
            <li class="footer-listitem link-list">
              <a class="footer-link-eu w-inline-block" href="/erdf/">
                <img class="logo-eu" sizes="100px" src="../../../_static/images/logo-eu-optimized-1.jpg" width="101">
              </a>
            </li>
          </ul>
        </div>
      </div>
      <div class="w-row">
        <a class="brand footer-brand w-inline-block" href="/">
          <img src="../../../_static/images/logo-crate.png" width="217">
        </a>
      </div>
    </div>
  </div>
</footer>

  <script>
  var $navAffix = $('#nav-affix');
  var $contentEl = $('.wrapper-content-right');
  // Desktop only
  if( !$('#mobile-menu-toggler').is(':visible') ) {

    // Only if the content is taller than the sidebar,
    // to avoid scroll jerk
    if ( $contentEl.height() > $navAffix.height() ) {
      // Init
      $navAffix.affix({
        offset: {
          top: 100,
          bottom: function () {
            return (this.bottom = $('footer').outerHeight(true) + 200)
          }
        }
      });
      // Recalculate the sidebar
      $(window).resize(function() {
        $navAffix.affix('checkPosition');
      });
    }

    $('body').scrollspy();

  } else {

    $('.wrapper-navleft').hide();
    $('#mobile-menu-toggler').click(function() {
      $('.wrapper-navleft').toggle();
    });

  }

  $(document).ready(function() {
    window.setTimeout(function() {$('body').append('<a href="https://crate.io/docs/support/slackin/" style="z-index: 10; position: fixed; bottom: 20px; right: ' + ($('#intercom-launcher').is(':visible') ? '90' : '20') + 'px; box-shadow: 0 6px 13px 0 rgba(0, 0, 0, .23)"><img src="../../../_static/images/slack.png" id="slack-container" /></a>'); }, 2000);
  });
  </script>

  <!-- Segment -->
  <script>
    !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","setAnonymousId"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="4.0.0";
      analytics.load("FToR4cE5lXyQziQirvt0kSnFQj0rAgu9");
      analytics.setAnonymousId($.cookie('uid'));
      analytics.page();
      analytics.track('visited_section_docs', {
        project: 'crate',
        version: ''
      });
    }}();
  </script>
  </body>
</html>