<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>User-Defined Functions &mdash; CrateDB  documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../_static/css/normalize.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../_static/css/bootstrap.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../_static/css/mmenu.all.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../_static/css/components.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../_static/css/crateio.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../_static/css/crateio-rtd.css?ver=1.1" type="text/css" />
    <link rel="stylesheet" href="../_static/css/custom.css?ver=1.1" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!--[if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif]-->
    <script type="text/javascript" src="https://cdn.crate.io/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script type="text/javascript" src="../_static/js/modernizr.js?ver=1.1"></script>
    <script type="text/javascript" src="../_static/js/underscore.min.js?ver=1.1"></script>
    <script type="text/javascript" src="../_static/doctools.js?ver=1.1"></script>
    <script type="text/javascript" src="../_static/js/searchtools.js?ver=1.1"></script>
    <script type="text/javascript" src="../_static/js/webflow.js?ver=1.1"></script>
    <script type="text/javascript" src="../_static/js/bootstrap.js?ver=1.1"></script>
    <script type="text/javascript" src="../_static/js/mmenu.all.min.js?ver=1.1"></script>
    <script type="text/javascript" src="../_static/js/fontawesome.js?ver=1.1"></script>
    <script type="text/javascript" src="../_static/js/custom.js?ver=1.1"></script>
    <link rel="top" title="CrateDB  documentation" href="../index.html" />
    <link rel="up" title="General Use" href="index.html" />
    <link rel="next" title="Blobs" href="blobs.html" />
    <link rel="prev" title="Subquery Expressions" href="builtins/subquery-expressions.html" />
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
  <meta name="apple-mobile-web-app-capable" content="yes">
  
  </head>
  <body>
  <header class="header-nav">
  <div class="container">
    <div class="navbar w-nav" data-animation="default" data-collapse="small" data-contain="1" data-duration="400">
      <a class="brand w-nav-brand" href="https://crate.io">
        <img src="../_static/images/logo-crate.png" width="217">
      </a>
      <nav class="w-nav-menu main-nav" role="navigation">
        <div class="dropdownBackground">
          <span class="arrow"></span>
        </div>
        <ul id="menu-top-navigation" class="menu">
          <li class="navlink w-nav-link menu-item"><a href="https://crate.io/overview/">CrateDB</a></li>
          <li class="navlink w-nav-link menu-item menu-item-has-children"><a href="https://crate.io/cratedb-solutions/">Use Cases</a>
            <ul class="sub-menu">
              <li class="menu-item"><a href="https://crate.io/customers/">Customers</a></li>
              <li class="menu-item"><a href="https://crate.io/iot-sensor-solutions/">IoT &amp; Sensor Data</a></li>
              <li class="menu-item"><a href="https://crate.io/geospatial-analytics/">Geospatial Analytics</a></li>
              <li class="menu-item"><a href="https://crate.io/cyber-security/">Cyber Security</a></li>
              <li class="menu-item"><a href="https://crate.io/time-series/">Time Series</a></li>
            </ul>
          </li>
          <li class="navlink w-nav-link menu-item"><a href="https://crate.io/pricing/">Pricing</a></li>
          <li class="navlink w-nav-link menu-item menu-item-has-children"><a>Resources</a>
            <ul class="sub-menu">
              <li class="menu-item"><a href="https://crate.io/docs/">Documentation</a></li>
              <li class="menu-item"><a href="https://crate.io/resources/">Resource Library</a></li>
              <li class="menu-item"><a href="https://crate.io/blog/">Blog</a></li>
              <li class="menu-item"><a href="https://crate.io/community/">Community</a></li>
            </ul>
          </li>
          <li class="btn-link w-nav-link menu-item"><a href="https://crate.io/download/">Download</a></li>
        </ul>
      </nav>

      <div id="mobile-nav" class="mm-menu">
        <ul class="offcanvas-menu">
          <li class="navlink w-nav-link menu-item"><a href="https://crate.io/overview/">CrateDB</a></li>
          <li class="navlink w-nav-link menu-item menu-item-has-children"><a href="https://crate.io/cratedb-solutions/">Use Cases</a>
            <ul class="sub-menu">
              <li class="menu-item"><a href="https://crate.io/customers/">Customers</a></li>
              <li class="menu-item"><a href="https://crate.io/iot-sensor-solutions/">IoT &amp; Sensor Data</a></li>
              <li class="menu-item"><a href="https://crate.io/geospatial-analytics/">Geospatial Analytics</a></li>
              <li class="menu-item"><a href="https://crate.io/cyber-security/">Cyber Security</a></li>
              <li class="menu-item"><a href="https://crate.io/time-series/">Time Series</a></li>
            </ul>
          </li>
          <li class="navlink w-nav-link menu-item"><a href="https://crate.io/pricing/">Pricing</a></li>
          <li class="navlink w-nav-link menu-item menu-item-has-children"><a>Resources</a>
            <ul class="sub-menu">
              <li class="menu-item"><a href="https://crate.io/docs/">Documentation</a></li>
              <li class="menu-item"><a href="https://crate.io/resources/">Resource Library</a></li>
              <li class="menu-item"><a href="https://crate.io/blog/">Blog</a></li>
              <li class="menu-item"><a href="https://crate.io/community/">Community</a></li>
            </ul>
          </li>
          <li class="btn-link w-nav-link menu-item"><a href="https://crate.io/download/">Download</a></li>
        </ul>
      </div>

      <a href="#mobile-nav" class="fa fa-bars mobile-nav-button"></a>
    </div>
  </div>
</header>

  <div class="w-section section border-top">
    <div class="w-container w-hidden-main margin-bottom-32">
      <div class="section" style="margin: 0px">
        <a href="#" id="mobile-menu-toggler" class="w-button">Toggle Doc Menu</a>
      </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="col-md-4 col-lg-3">
          <aside class="wrapper-navleft"><div role="complementary" class="bs-docs-sidebar hidden-print" id="nav-affix">
  <div class="search-link">
    <a href="../search.html" class="btn btn-primary">Search Documentation</a>
  </div>
  <ul class="bs-docs-sidenav bs-sidenav nav" role="complementary">

    

    
      <ul class="toctree nav nav-list">
  <li class="navleft-item">CrateDB</li>
  <ul>
    
    <li class="navleft-item"><a href="/docs/crate/getting-started/">Getting Started</a></li>
    
    
    <li class="current">
      <a class="current-active" href="../index.html" title="CrateDB">Reference</a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../run.html">Running CrateDB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../run.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../run.html#command-line-options">Command Line Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../run.html#signal-handling">Signal Handling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../config/index.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../config/node.html">Node Specific Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#basics">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#node-types">Node Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#read-only-node">Read-only node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#hosts">Hosts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#ports">Ports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#paths">Paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#plugins">Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#memory">Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#garbage-collection">Garbage Collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#elasticsearch-http-rest-api">Elasticsearch HTTP REST API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#cross-origin-resource-sharing-cors">Cross-Origin Resource Sharing (CORS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#blobs">Blobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#repositories">Repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#queries">Queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/node.html#custom-attributes">Custom Attributes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../config/cluster.html">Cluster Wide Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#non-runtime-cluster-wide-settings">Non-Runtime Cluster Wide Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#collecting-stats">Collecting Stats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#usage-data-collector">Usage Data Collector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#graceful-stop">Graceful Stop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#bulk-operations">Bulk Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#discovery">Discovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#routing-allocation">Routing Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#recovery">Recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#store-level-throttling">Store Level Throttling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#query-circuit-breaker">Query Circuit Breaker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#field-data-circuit-breaker">Field Data Circuit Breaker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#request-circuit-breaker">Request Circuit Breaker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#thread-pools">Thread Pools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/cluster.html#metadata">Metadata</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../config/session.html">Session Setting Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config/logging.html">Logging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../config/logging.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/logging.html#settings">Settings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../config/environment.html">Environment Variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../config/environment.html#crate-home"><code class="docutils literal"><span class="pre">CRATE_HOME</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/environment.html#crate-java-opts"><code class="docutils literal"><span class="pre">CRATE_JAVA_OPTS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/environment.html#crate-heap-size"><code class="docutils literal"><span class="pre">CRATE_HEAP_SIZE</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../config/system.html">Operating System Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../config/system.html#virtual-memory">Virtual Memory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../config/enterprise.html">Enterprise Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../config/enterprise.html#enterprise-license">Enterprise License</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/enterprise.html#javascript-language">Javascript Language</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/enterprise.html#authentication">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../config/enterprise.html#secured-communications-ssl-tls">Secured Communications (SSL/TLS)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">General Use</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ddl/index.html">Data Definition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ddl/create-table.html">Creating Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl/data-types.html">Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl/system-columns.html">System Columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl/generated-columns.html">Generated Columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl/constraints.html">Constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl/storage.html">Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl/partitioned-tables.html">Partitioned Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl/sharding.html">Sharding</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl/replication.html">Replication</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl/column-policy.html">Column Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl/fulltext-indices.html">Fulltext Indices</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl/analyzers.html">Fulltext Analyzers</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl/show-create-table.html">Show Create Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl/alter-table.html">Altering Tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dml.html">Data Manipulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dml.html#inserting-data">Inserting Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="dml.html#updating-data">Updating Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="dml.html#deleting-data">Deleting Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="dml.html#import-and-export">Import and Export</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dql/index.html">Querying Crate</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dql/selects.html">Selecting Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="dql/joins.html">Joins</a></li>
<li class="toctree-l3"><a class="reference internal" href="dql/union.html">Union All</a></li>
<li class="toctree-l3"><a class="reference internal" href="dql/refresh.html">Refresh</a></li>
<li class="toctree-l3"><a class="reference internal" href="dql/fulltext.html">Fulltext Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="dql/geo.html">Geo Search</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="builtins/index.html">Built-in Functions and Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="builtins/scalar.html">Scalar Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="builtins/aggregation.html">Aggregation</a></li>
<li class="toctree-l3"><a class="reference internal" href="builtins/arithmetic.html">Arithmetic Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="builtins/table-functions.html">Table Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="builtins/operators.html">Comparison Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="builtins/array-comparisons.html">Array Comparisons</a></li>
<li class="toctree-l3"><a class="reference internal" href="builtins/subquery-expressions.html">Subquery Expressions</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">User-Defined Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-or-replace"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">OR</span> <span class="pre">REPLACE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-types">Supported Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#overloading">Overloading</a></li>
<li class="toctree-l3"><a class="reference internal" href="#determinism">Determinism</a></li>
<li class="toctree-l3"><a class="reference internal" href="#drop-function"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">FUNCTION</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-languages">Supported Languages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="blobs.html">Blobs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="blobs.html#creating-a-table-for-blobs">Creating a Table for Blobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="blobs.html#custom-location-for-storing-blob-data">Custom Location for Storing Blob Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="blobs.html#list">List</a></li>
<li class="toctree-l3"><a class="reference internal" href="blobs.html#altering-a-blob-table">Altering a Blob Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="blobs.html#deleting-a-blob-table">Deleting a Blob Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="blobs.html#using-blob-tables">Using Blob Tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="occ.html">Optimistic Concurrency Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="occ.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="occ.html#optimistic-update">Optimistic Update</a></li>
<li class="toctree-l3"><a class="reference internal" href="occ.html#optimistic-delete">Optimistic Delete</a></li>
<li class="toctree-l3"><a class="reference internal" href="occ.html#known-limitations">Known Limitations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="information-schema.html">Information Schema</a><ul>
<li class="toctree-l3"><a class="reference internal" href="information-schema.html#access">Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="information-schema.html#virtual-tables">Virtual Tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../admin/index.html">Administration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../admin/system-information.html">System Information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/system-information.html#cluster">Cluster</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/system-information.html#nodes">Nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/system-information.html#node-checks">Node Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/system-information.html#shards">Shards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/system-information.html#jobs-operations-and-logs">Jobs, Operations, and Logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/system-information.html#cluster-checks">Cluster Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/system-information.html#repositories">Repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/system-information.html#snapshots">Snapshots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/system-information.html#summits">Summits</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/system-information.html#users">Users</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/system-information.html#allocations">Allocations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/system-information.html#shard-table-permissions">Shard Table Permissions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../admin/runtime-config.html">Runtime Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../admin/user-management.html">User Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/user-management.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/user-management.html#create-user"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">USER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/user-management.html#alter-user"><code class="docutils literal"><span class="pre">ALTER</span> <span class="pre">USER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/user-management.html#drop-user"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">USER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/user-management.html#list-users">List Users</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../admin/privileges.html">Privileges</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/privileges.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/privileges.html#privilege-types">Privilege Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/privileges.html#hierarchical-inheritance-of-privileges">Hierarchical Inheritance of Privileges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/privileges.html#behavior-of-grant-deny-and-revoke">Behavior of <code class="docutils literal"><span class="pre">GRANT</span></code>, <code class="docutils literal"><span class="pre">DENY</span></code> and <code class="docutils literal"><span class="pre">REVOKE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/privileges.html#list-privileges">List Privileges</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../admin/auth/index.html">Authentication</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/auth/methods.html">Authentication Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/auth/hba.html">Host Based Authentication (HBA)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../admin/ssl.html">Secured Communications (SSL/TLS)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/ssl.html#ssl-tls-configuration">SSL/TLS Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/ssl.html#setting-up-a-keystore-truststore-with-a-certificate-chain">Setting up a Keystore/Truststore With a Certificate Chain</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../admin/ingestion/index.html">Ingestion Framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/ingestion/sources/index.html">Ingestion Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/ingestion/rules.html">Ingestion Rules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../admin/optimization.html">Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/optimization.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/optimization.html#multiple-table-optimization">Multiple Table Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/optimization.html#partition-optimization">Partition Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/optimization.html#segments-upgrade">Segments Upgrade</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../admin/jobs-management.html">Jobs Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../admin/monitoring.html">JMX Monitoring</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/monitoring.html#setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/monitoring.html#using-docker">Using Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/monitoring.html#jmx-beans">JMX Beans</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../admin/snapshots.html">Snapshots</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/snapshots.html#snapshot">Snapshot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/snapshots.html#restore">Restore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/snapshots.html#cleanup">Cleanup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/snapshots.html#requirements-for-using-hdfs-repositories">Requirements for Using HDFS Repositories</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../admin/discovery.html">Cloud Discovery</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/discovery.html#amazon-ec2-discovery">Amazon EC2 Discovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/discovery.html#microsoft-azure-discovery">Microsoft Azure Discovery</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../admin/udc.html">Usage Data Collector</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../admin/udc.html#technical-information">Technical Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/udc.html#admin-ui-tracking">Admin UI Tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/udc.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../admin/udc.html#how-to-disable-udc">How to Disable UDC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sql/index.html">SQL Syntax</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sql/general/index.html">General SQL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sql/general/constraints.html">Constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/general/value-expressions.html">Value Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/general/lexical-structure.html">Lexical Structure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sql/statements/index.html">SQL Statements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/alter-cluster.html"><code class="docutils literal"><span class="pre">ALTER</span> <span class="pre">CLUSTER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/alter-table.html"><code class="docutils literal"><span class="pre">ALTER</span> <span class="pre">TABLE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/alter-user.html"><code class="docutils literal"><span class="pre">ALTER</span> <span class="pre">USER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/copy-from.html"><code class="docutils literal"><span class="pre">COPY</span> <span class="pre">FROM</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/copy-to.html"><code class="docutils literal"><span class="pre">COPY</span> <span class="pre">TO</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/create-analyzer.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">ANALYZER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/create-blob-table.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">BLOB</span> <span class="pre">TABLE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/create-function.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">FUNCTION</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/create-ingest-rule.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">INGEST</span> <span class="pre">RULE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/create-repository.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">REPOSITORY</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/create-snapshot.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">SNAPSHOT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/create-table.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/create-user.html"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">USER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/delete.html"><code class="docutils literal"><span class="pre">DELETE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/deny.html"><code class="docutils literal"><span class="pre">DENY</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/drop-function.html"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">FUNCTION</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/drop-ingest-rule.html"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">INGEST</span> <span class="pre">RULE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/drop-repository.html"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">REPOSITORY</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/drop-snapshot.html"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">SNAPSHOT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/drop-table.html"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">TABLE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/drop-user.html"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">USER</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/explain.html"><code class="docutils literal"><span class="pre">EXPLAIN</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/grant.html"><code class="docutils literal"><span class="pre">GRANT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/insert.html"><code class="docutils literal"><span class="pre">INSERT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/kill.html"><code class="docutils literal"><span class="pre">KILL</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/optimize.html"><code class="docutils literal"><span class="pre">OPTIMIZE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/refresh.html"><code class="docutils literal"><span class="pre">REFRESH</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/restore-snapshot.html"><code class="docutils literal"><span class="pre">RESTORE</span> <span class="pre">SNAPSHOT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/revoke.html"><code class="docutils literal"><span class="pre">REVOKE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/select.html"><code class="docutils literal"><span class="pre">SELECT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/set.html"><code class="docutils literal"><span class="pre">SET</span></code> and <code class="docutils literal"><span class="pre">RESET</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/set-transaction.html"><code class="docutils literal"><span class="pre">SET</span> <span class="pre">TRANSACTION</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/show-columns.html"><code class="docutils literal"><span class="pre">SHOW</span> <span class="pre">COLUMNS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/show-create-table.html"><code class="docutils literal"><span class="pre">SHOW</span> <span class="pre">CREATE</span> <span class="pre">TABLE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/show-schemas.html"><code class="docutils literal"><span class="pre">SHOW</span> <span class="pre">SCHEMAS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/show-tables.html"><code class="docutils literal"><span class="pre">SHOW</span> <span class="pre">TABLES</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../sql/statements/update.html"><code class="docutils literal"><span class="pre">UPDATE</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../interfaces/index.html">Client Interfaces</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../interfaces/http.html">HTTP Endpoint</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/http.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/http.html#parameter-substitution">Parameter Substitution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/http.html#default-schema">Default Schema</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/http.html#column-types">Column Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/http.html#bulk-operations">Bulk Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/http.html#error-handling">Error Handling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../interfaces/postgres.html">PostgreSQL Wire Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/postgres.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/postgres.html#server-compatibility-and-implementation-status">Server Compatibility and Implementation Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/postgres.html#client-compatibility">Client Compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/postgres.html#implementation-differences">Implementation Differences</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise/index.html">Enterprise Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/index.html">Appendices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendices/release-notes/index.html">Release Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../appendices/release-notes/index.html#x">2.x</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendices/release-notes/index.html#id6">1.x</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../appendices/sql-compliance.html">Standard SQL Compliance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../appendices/sql-compliance.html#data-types">Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendices/sql-compliance.html#create-table">Create Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendices/sql-compliance.html#alter-table">Alter Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendices/sql-compliance.html#insert-update-and-delete">Insert, Update, and Delete</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendices/sql-compliance.html#system-information-tables">System Information Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendices/sql-compliance.html#blob-support">BLOB Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendices/sql-compliance.html#transactions-begin-commit-and-rollback">Transactions (<code class="docutils literal"><span class="pre">BEGIN</span></code>, <code class="docutils literal"><span class="pre">COMMIT</span></code>, and <code class="docutils literal"><span class="pre">ROLLBACK</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../appendices/sql-compliance.html#unsupported-features-and-functions">Unsupported Features and Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../appendices/supported-features.html">Supported Features</a></li>
</ul>
</li>
</ul>

    </li>
    
    
    <li class="navleft-item"><a href="/docs/crate/guide">Guide</a></li>
    
  </ul>
  <li class="navleft-item">CrateDB Clients</li>
  <ul>
    
    <li class="navleft-item"><a href="/docs/clients/crash">The CrateDB Shell</a></li>
    
    
    <li class="navleft-item"><a href="/docs/clients/python">Python</a></li>
    
    
    <li class="navleft-item"><a href="/docs/clients/jdbc">JDBC</a></li>
    
    
    <li class="navleft-item"><a href="/docs/clients/dbal">PHP DBAL</a></li>
    
    
    <li class="navleft-item"><a href="/docs/clients/pdo">PHP PDO</a></li>
    
  </ul>

  <li class="navleft-item border-top"><a href="https://github.com/crate/crate-sample-apps">Sample Applications</a></li>
  <li class="navleft-item"><a href="/docs/support/">Support</a></li>
</ul>
    

    
      
      
    

    
    

    
      <li></li>
    

  </ul>
</div>
            
          </aside>
        </div>
        <div class="col-md-8 col-lg-9">
          <div class="wrapper-content-right">
            
  <div class="section" id="user-defined-functions">
<span id="sql-administration-udf"></span><h1>User-Defined Functions<a class="headerlink" href="#user-defined-functions" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="#udf-lang-js"><span class="std std-ref">JavaScript</span></a> language is an <a class="reference internal" href="../enterprise/index.html#enterprise-features"><span class="std std-ref">enterprise feature</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="#udf-lang-js"><span class="std std-ref">JavaScript</span></a> language is an experimental feature and is disabled
by default. You can enable the <a class="reference internal" href="../config/enterprise.html#conf-lang-js-enabled"><span class="std std-ref">Javascript Language</span></a> via the
configuration file.</p>
</div>
<p class="rubric">Table of Contents</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#create-or-replace" id="id2"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">OR</span> <span class="pre">REPLACE</span></code></a></li>
<li><a class="reference internal" href="#supported-types" id="id3">Supported Types</a></li>
<li><a class="reference internal" href="#overloading" id="id4">Overloading</a></li>
<li><a class="reference internal" href="#determinism" id="id5">Determinism</a></li>
<li><a class="reference internal" href="#drop-function" id="id6"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">FUNCTION</span></code></a></li>
<li><a class="reference internal" href="#supported-languages" id="id7">Supported Languages</a><ul>
<li><a class="reference internal" href="#javascript" id="id8">JavaScript</a><ul>
<li><a class="reference internal" href="#id1" id="id9">Supported Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-numbers" id="id10">Working with <code class="docutils literal"><span class="pre">NUMBERS</span></code></a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="create-or-replace">
<h2><a class="toc-backref" href="#id2"><code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">OR</span> <span class="pre">REPLACE</span></code></a><a class="headerlink" href="#create-or-replace" title="Permalink to this headline">¶</a></h2>
<p>CrateDB supports user-defined functions. See <a class="reference internal" href="../sql/statements/create-function.html#ref-create-function"><span class="std std-ref">CREATE FUNCTION</span></a> for a
full syntax description.</p>
<p>These functions can be created like so:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">FUNCTION</span> <span class="n">subtract</span><span class="p">(</span><span class="n">integer</span><span class="p">,</span> <span class="n">integer</span><span class="p">)</span>
<span class="o">...</span>  <span class="n">RETURNS</span> <span class="n">integer</span>
<span class="o">...</span>  <span class="n">LANGUAGE</span> <span class="n">JAVASCRIPT</span>
<span class="o">...</span>  <span class="n">AS</span> <span class="s1">&#39;function subtract(a, b) { return a - b; }&#39;</span><span class="p">;</span>
<span class="n">CREATE</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">subtract</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="o">+----------------+</span>
<span class="o">|</span> <span class="n">subtract</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+----------------+</span>
<span class="o">|</span>              <span class="mi">2</span> <span class="o">|</span>
<span class="o">+----------------+</span>
<span class="n">SELECT</span> <span class="mi">1</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">OR</span> <span class="pre">REPLACE</span></code> can be used to replace an existing function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">OR</span> <span class="n">REPLACE</span> <span class="n">FUNCTION</span> <span class="n">log10</span><span class="p">(</span><span class="n">long</span><span class="p">)</span>
<span class="o">...</span>  <span class="n">RETURNS</span> <span class="n">double</span>
<span class="o">...</span>  <span class="n">LANGUAGE</span> <span class="n">JAVASCRIPT</span>
<span class="o">...</span>  <span class="n">AS</span> <span class="s1">&#39;function log10(a) { return Math.log(a)/Math.log(10); }&#39;</span><span class="p">;</span>
<span class="n">CREATE</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="o">+-----------+</span>
<span class="o">|</span> <span class="n">log10</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+-----------+</span>
<span class="o">|</span>       <span class="mf">1.0</span> <span class="o">|</span>
<span class="o">+-----------+</span>
<span class="n">SELECT</span> <span class="mi">1</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>Arguments can be named in the function definition.</p>
<p>For example, if you wanted two <code class="docutils literal"><span class="pre">geo_point</span></code> arguments named <code class="docutils literal"><span class="pre">start_point</span></code>
and <code class="docutils literal"><span class="pre">end_point</span></code>, you would do it like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">OR</span> <span class="n">REPLACE</span> <span class="n">FUNCTION</span> <span class="n">calculate_distance</span><span class="p">(</span><span class="n">start_point</span> <span class="n">geo_point</span><span class="p">,</span> <span class="n">end_point</span> <span class="n">geo_point</span><span class="p">)</span>
<span class="o">...</span>  <span class="n">RETURNS</span> <span class="nb">float</span>
<span class="o">...</span>  <span class="n">LANGUAGE</span> <span class="n">JAVASCRIPT</span>
<span class="o">...</span>  <span class="n">AS</span> <span class="s1">&#39;function calculate_distance(start_point, end_point){</span>
<span class="o">...</span>        <span class="k">return</span> <span class="n">Math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">Math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">end_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">start_point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">end_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">start_point</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">));</span>
<span class="o">...</span>      <span class="p">}</span><span class="s1">&#39;;</span>
<span class="n">CREATE</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Argument names are used for query documentation purposes only. You cannot
reference arguments by name in the function body.</p>
</div>
<p>Optionally, you can specify a schema for the function. If you omit the schema,
the current session schema is used.</p>
<p>You can explicitly assign a schema like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">OR</span> <span class="n">REPLACE</span> <span class="n">FUNCTION</span> <span class="n">my_schema</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">long</span><span class="p">)</span>
<span class="o">...</span>  <span class="n">RETURNS</span> <span class="n">double</span>
<span class="o">...</span>  <span class="n">LANGUAGE</span> <span class="n">JAVASCRIPT</span>
<span class="o">...</span>  <span class="n">AS</span> <span class="s1">&#39;function log10(a) { return Math.log(a)/Math.log(10); }&#39;</span><span class="p">;</span>
<span class="n">CREATE</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><a class="reference internal" href="../admin/snapshots.html#snapshot-restore"><span class="std std-ref">Snapshots</span></a> can&#8217;t be used to backup functions, because snapshots
contain table data only.</p>
</div>
</div>
<div class="section" id="supported-types">
<h2><a class="toc-backref" href="#id3">Supported Types</a><a class="headerlink" href="#supported-types" title="Permalink to this headline">¶</a></h2>
<p>The argument types, and the return type of the function can be any of the
CrateDB supported <a class="reference internal" href="ddl/data-types.html#data-types"><span class="std std-ref">Data Types</span></a>. Data types of values passed into a
function must strictly correspond to its argument data types.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The value returned by the function will be casted to the return type
provided in the definition if required. An exception will be thrown if the
cast is not successful.</p>
</div>
</div>
<div class="section" id="overloading">
<h2><a class="toc-backref" href="#id4">Overloading</a><a class="headerlink" href="#overloading" title="Permalink to this headline">¶</a></h2>
<p>Within a specific schema, you can overload functions by defining two functions
with the same name that have a different set of arguments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">FUNCTION</span> <span class="n">my_schema</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">integer</span><span class="p">,</span> <span class="n">integer</span><span class="p">)</span>
<span class="o">...</span>  <span class="n">RETURNS</span> <span class="n">integer</span>
<span class="o">...</span>  <span class="n">LANGUAGE</span> <span class="n">JAVASCRIPT</span>
<span class="o">...</span>  <span class="n">AS</span> <span class="s1">&#39;function multiply(a, b) { return a * b; }&#39;</span><span class="p">;</span>
<span class="n">CREATE</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>This would overload our <code class="docutils literal"><span class="pre">multiply</span></code> function with different argument types:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">FUNCTION</span> <span class="n">my_schema</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">long</span><span class="p">,</span> <span class="n">long</span><span class="p">)</span>
<span class="o">...</span>  <span class="n">RETURNS</span> <span class="n">long</span>
<span class="o">...</span>  <span class="n">LANGUAGE</span> <span class="n">JAVASCRIPT</span>
<span class="o">...</span>  <span class="n">AS</span> <span class="s1">&#39;function multiply(a, b) { return a * b; }&#39;</span><span class="p">;</span>
<span class="n">CREATE</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>This would overload our <code class="docutils literal"><span class="pre">multiply</span></code> function with more arguments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">FUNCTION</span> <span class="n">my_schema</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">long</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">long</span><span class="p">)</span>
<span class="o">...</span>  <span class="n">RETURNS</span> <span class="n">long</span>
<span class="o">...</span>  <span class="n">LANGUAGE</span> <span class="n">JAVASCRIPT</span>
<span class="o">...</span>  <span class="n">AS</span> <span class="s1">&#39;function multiply(a, b, c) { return a * b * c; }&#39;</span><span class="p">;</span>
<span class="n">CREATE</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>It is considered bad practice to create functions that have the same name
as the CrateDB built-in functions.</p>
<p>If you call a function without a schema name, CrateDB will look it up in
the built-in functions first and only then in the user-defined functions
with the schema of the current session (see
<a class="reference internal" href="../config/session.html#conf-session-settings"><span class="std std-ref">Session Setting Parameters</span></a>).</p>
<p class="last">Therefore a built-in function with the same name as a user-defined function
will hide the latter. However, such functions can still be called if the
schema name is explicitly provided.</p>
</div>
</div>
<div class="section" id="determinism">
<h2><a class="toc-backref" href="#id5">Determinism</a><a class="headerlink" href="#determinism" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">User-defined functions need to be deterministic, meaning that they must
always return the same result value when called with the same argument
values, because CrateDB might cache the returned values and reuse the value
if the function is called multiple times with the same arguments.</p>
</div>
</div>
<div class="section" id="drop-function">
<h2><a class="toc-backref" href="#id6"><code class="docutils literal"><span class="pre">DROP</span> <span class="pre">FUNCTION</span></code></a><a class="headerlink" href="#drop-function" title="Permalink to this headline">¶</a></h2>
<p>Functions can be dropped like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">DROP</span> <span class="n">FUNCTION</span> <span class="n">log10</span><span class="p">(</span><span class="n">long</span><span class="p">);</span>
<span class="n">DROP</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>Adding <code class="docutils literal"><span class="pre">IF</span> <span class="pre">EXISTS</span></code> prevents from raising an error if the function doesn&#8217;t
exist:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">DROP</span> <span class="n">FUNCTION</span> <span class="n">IF</span> <span class="n">EXISTS</span> <span class="n">log10</span><span class="p">(</span><span class="n">integer</span><span class="p">);</span>
<span class="n">DROP</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>Optionally, argument names can be specified within the drop statement:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">DROP</span> <span class="n">FUNCTION</span> <span class="n">IF</span> <span class="n">EXISTS</span> <span class="n">calculate_distance</span><span class="p">(</span><span class="n">start_point</span> <span class="n">geo_point</span><span class="p">,</span> <span class="n">end_point</span> <span class="n">geo_point</span><span class="p">);</span>
<span class="n">DROP</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>Optionally, you can provide a schema:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">DROP</span> <span class="n">FUNCTION</span> <span class="n">my_schema</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">long</span><span class="p">);</span>
<span class="n">DROP</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="supported-languages">
<h2><a class="toc-backref" href="#id7">Supported Languages</a><a class="headerlink" href="#supported-languages" title="Permalink to this headline">¶</a></h2>
<p>CrateDB currently only supports the UDF language <code class="docutils literal"><span class="pre">javascript</span></code>.</p>
<div class="section" id="javascript">
<span id="udf-lang-js"></span><h3><a class="toc-backref" href="#id8">JavaScript</a><a class="headerlink" href="#javascript" title="Permalink to this headline">¶</a></h3>
<p>The UDF language <code class="docutils literal"><span class="pre">javascript</span></code> supports the <a class="reference external" href="https://www.ecma-international.org/ecma-262/5.1/">ECMAScript 5.1</a> standard.</p>
<p>CrateDB uses the Java built-in JavaScript engine <a class="reference external" href="http://www.oracle.com/technetwork/articles/java/jf14-nashorn-2126515.html">Nashorn</a> to interpret and
execute functions written in JavaScript. The engine is initialized using the
<code class="docutils literal"><span class="pre">--no-java</span></code> option which basically restricts all access to Java APIs from
within the JavaScript context. CrateDB&#8217;s engine also does not allow
non-standard syntax extensions (<code class="docutils literal"><span class="pre">--no-syntax-extensions</span></code>).</p>
<p><strong>This, however, does not mean that JavaScript is securely sandboxed.</strong></p>
<p>Also, even though Nashorn runs ECMA-complient JavaScript, objects that are
normally accessible with a web browser (e.g. <code class="docutils literal"><span class="pre">window</span></code>, <code class="docutils literal"><span class="pre">console</span></code> and so on)
are are not available.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The JavaScript language is an <a class="reference internal" href="../enterprise/index.html#enterprise-features"><span class="std std-ref">enterprise feature</span></a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="#udf-lang-js"><span class="std std-ref">JavaScript</span></a> language is an experimental feature and is disabled
by default. You can enable the <a class="reference internal" href="../config/enterprise.html#conf-lang-js-enabled"><span class="std std-ref">Javascript Language</span></a> via the
configuration file.</p>
</div>
<div class="section" id="id1">
<h4><a class="toc-backref" href="#id9">Supported Types</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>JavaScript functions can handle all CrateDB data types. However, for some
return types the function output must correspond to the certain format.</p>
<p>If a function requires <code class="docutils literal"><span class="pre">geo_point</span></code> as a return type, then the JavaScript
function must return a <code class="docutils literal"><span class="pre">double</span> <span class="pre">array</span></code> of size 2, <code class="docutils literal"><span class="pre">WKT</span></code> string or
<code class="docutils literal"><span class="pre">GeoJson</span></code> object.</p>
<p>Here is an example of a JavaScript function returning a <code class="docutils literal"><span class="pre">double</span> <span class="pre">array</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">FUNCTION</span> <span class="n">rotate_point</span><span class="p">(</span><span class="n">point</span> <span class="n">geo_point</span><span class="p">,</span> <span class="n">angle</span> <span class="nb">float</span><span class="p">)</span>
<span class="o">...</span>  <span class="n">RETURNS</span> <span class="n">geo_point</span>
<span class="o">...</span>  <span class="n">LANGUAGE</span> <span class="n">JAVASCRIPT</span>
<span class="o">...</span>  <span class="n">AS</span> <span class="s1">&#39;function rotate_point(point, angle) {</span>
<span class="o">...</span>        <span class="n">var</span> <span class="n">cos</span> <span class="o">=</span> <span class="n">Math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">);</span>
<span class="o">...</span>        <span class="n">var</span> <span class="n">sin</span> <span class="o">=</span> <span class="n">Math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">);</span>
<span class="o">...</span>        <span class="n">var</span> <span class="n">x</span> <span class="o">=</span> <span class="n">cos</span> <span class="o">*</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">sin</span> <span class="o">*</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="o">...</span>        <span class="n">var</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sin</span> <span class="o">*</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">cos</span> <span class="o">*</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="o">...</span>        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">];</span>
<span class="o">...</span>      <span class="p">}</span><span class="s1">&#39;;</span>
<span class="n">CREATE</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>Below is an example of a JavaScript function returning a <code class="docutils literal"><span class="pre">WKT</span></code> string, which
will be cast to <code class="docutils literal"><span class="pre">geo_point</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">FUNCTION</span> <span class="n">symmetric_point</span><span class="p">(</span><span class="n">point</span> <span class="n">geo_point</span><span class="p">)</span>
<span class="o">...</span>  <span class="n">RETURNS</span> <span class="n">geo_point</span>
<span class="o">...</span>  <span class="n">LANGUAGE</span> <span class="n">JAVASCRIPT</span>
<span class="o">...</span>  <span class="n">AS</span> <span class="s1">&#39;function symmetric_point (point, angle) {</span>
<span class="o">...</span>        <span class="n">var</span> <span class="n">x</span> <span class="o">=</span> <span class="o">-</span> <span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="o">...</span>            <span class="n">y</span> <span class="o">=</span> <span class="o">-</span> <span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="o">...</span>        <span class="k">return</span> <span class="s2">&quot;POINT (</span><span class="se">\&quot;</span><span class="s2"> + x + </span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2"> + y +</span><span class="se">\&quot;</span><span class="s2">)&quot;</span><span class="p">;</span>
<span class="o">...</span>      <span class="p">}</span><span class="s1">&#39;;</span>
<span class="n">CREATE</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>Similarly, if the function specifies the <code class="docutils literal"><span class="pre">geo_shape</span></code> return data type, then
the JavaScript function should return a <code class="docutils literal"><span class="pre">GeoJson</span></code> object or``WKT`` string:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">FUNCTION</span> <span class="n">line</span><span class="p">(</span><span class="n">start_point</span> <span class="n">array</span><span class="p">(</span><span class="n">double</span><span class="p">),</span> <span class="n">end_point</span> <span class="n">array</span><span class="p">(</span><span class="n">double</span><span class="p">))</span>
<span class="o">...</span>  <span class="n">RETURNS</span> <span class="nb">object</span>
<span class="o">...</span>  <span class="n">LANGUAGE</span> <span class="n">JAVASCRIPT</span>
<span class="o">...</span>  <span class="n">AS</span> <span class="s1">&#39;function line(start_point, end_point) {</span>
<span class="o">...</span>        <span class="k">return</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;LineString&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="n">start_point</span><span class="p">,</span> <span class="n">end_point</span><span class="p">]</span> <span class="p">};</span>
<span class="o">...</span>      <span class="p">}</span><span class="s1">&#39;;</span>
<span class="n">CREATE</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the return value of the JavaScript function is <code class="docutils literal"><span class="pre">undefined</span></code>, it is
converted to <code class="docutils literal"><span class="pre">NULL</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="working-with-numbers">
<h3><a class="toc-backref" href="#id10">Working with <code class="docutils literal"><span class="pre">NUMBERS</span></code></a><a class="headerlink" href="#working-with-numbers" title="Permalink to this headline">¶</a></h3>
<p>The JavaScript engine <a class="reference external" href="http://www.oracle.com/technetwork/articles/java/jf14-nashorn-2126515.html">Nashorn</a> interprets numbers as <code class="docutils literal"><span class="pre">java.lang.Double</span></code>,
<code class="docutils literal"><span class="pre">java.lang.Long</span></code>, or <code class="docutils literal"><span class="pre">java.lang.Integer</span></code>, depending on the computation
performed. In most cases, this is not an issue, since the return type of the
JavaScript function will be cast to the return type specified in the <code class="docutils literal"><span class="pre">CREATE</span>
<span class="pre">FUNCTION</span></code> statement, although cast might result in a loss of precision.</p>
<p>However, when you try to cast <code class="docutils literal"><span class="pre">DOUBLE</span></code> to <code class="docutils literal"><span class="pre">TIMESTAMP</span></code>, it will be
interpreted as UTC seconds and will result in a wrong value:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">FUNCTION</span> <span class="n">utc</span><span class="p">(</span><span class="n">long</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">long</span><span class="p">)</span>
<span class="o">...</span>  <span class="n">RETURNS</span> <span class="n">TIMESTAMP</span>
<span class="o">...</span>  <span class="n">LANGUAGE</span> <span class="n">JAVASCRIPT</span>
<span class="o">...</span>  <span class="n">AS</span> <span class="s1">&#39;function utc(year, month, day) {</span>
<span class="o">...</span>        <span class="k">return</span> <span class="n">Date</span><span class="o">.</span><span class="n">UTC</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="o">...</span>      <span class="p">}</span><span class="s1">&#39;;</span>
<span class="n">CREATE</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">date_format</span><span class="p">(</span><span class="n">utc</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">04</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="k">as</span> <span class="n">epoque</span><span class="p">;</span>
<span class="o">+------------------------------+</span>
<span class="o">|</span> <span class="n">epoque</span>                       <span class="o">|</span>
<span class="o">+------------------------------+</span>
<span class="o">|</span> <span class="mi">48314</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">22</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span><span class="n">Z</span> <span class="o">|</span>
<span class="o">+------------------------------+</span>
<span class="n">SELECT</span> <span class="mi">1</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>To avoid this behavior, the numeric value should be divided by 1000 before it
is returned:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">CREATE</span> <span class="n">FUNCTION</span> <span class="n">utc</span><span class="p">(</span><span class="n">long</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">long</span><span class="p">)</span>
<span class="o">...</span>  <span class="n">RETURNS</span> <span class="n">TIMESTAMP</span>
<span class="o">...</span>  <span class="n">LANGUAGE</span> <span class="n">JAVASCRIPT</span>
<span class="o">...</span>  <span class="n">AS</span> <span class="s1">&#39;function utc(year, month, day) {</span>
<span class="o">...</span>        <span class="k">return</span> <span class="n">Date</span><span class="o">.</span><span class="n">UTC</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="p">;</span>
<span class="o">...</span>      <span class="p">}</span><span class="s1">&#39;;</span>
<span class="n">CREATE</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="n">affected</span>  <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cr</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">date_format</span><span class="p">(</span><span class="n">utc</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">04</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="k">as</span> <span class="n">epoque</span><span class="p">;</span>
<span class="o">+-----------------------------+</span>
<span class="o">|</span> <span class="n">epoque</span>                      <span class="o">|</span>
<span class="o">+-----------------------------+</span>
<span class="o">|</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">06</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span><span class="n">Z</span> <span class="o">|</span>
<span class="o">+-----------------------------+</span>
<span class="n">SELECT</span> <span class="mi">1</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="o">...</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
    </div>
  </div><footer class="footer">
  <div class="w-container">
    <div class="w-clearfix">
      <div class="w-row mobileAlign">
        <div class="w-col w-col-3 footer-menu">
          <p class="menu-Label">Product</p>
          <ul class="vertical-menu">
            <li class="footer-listitem-new"><a href="https://crate.io/overview/">Overview</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/download/">Download</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/use-cases/">Use Cases</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/customers/">Customers</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/pricing/">Pricing</a></li>
          </ul>
        </div>
        <div class="w-col w-col-3 footer-menu">
          <p class="menu-Label">Resources</p>
          <ul class="vertical-menu">
            <li class="footer-listitem-new"><a href="https://crate.io/resources/">Resource Library</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/docs/">Documentation</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/docs/support/">Support</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/events/">Events</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/blog/">Blog</a></li>
          </ul>
        </div>
        <div class="w-col w-col-3 footer-menu">
          <p class="menu-Label">Company</p>
          <ul class="vertical-menu">
            <li class="footer-listitem-new "><a href="https://crate.io/about/">About</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/jobs/">Jobs</a></li>
            <li class="footer-listitem-new "><a href="https://crate.io/partners/">Partners</a></li>
            <li class="footer-listitem-new"><a href="https://crate.io/in-the-news/">In the News</a></li>
          </ul>
        </div>
        <div class="w-col w-col-3">
          <ul class="footer-list w-list-unstyled" style="margin-top: 0; padding-left: 0;">
            <li class="footer-listitem">
              <a class="footer-link-connect w-inline-block" href="https://www.facebook.com/crate.io" target="_blank" style="padding-left: 0;">
                <img src="../_static/images/f-logo-facebook.png" width="12">
              </a>
            </li>
            <li class="footer-listitem">
              <a class="footer-link-connect w-inline-block" href="https://twitter.com/Crateio" target="_blank">
                <img src="../_static/images/f-logo-twitter.png" width="23">
              </a>
            </li>
            <li class="footer-listitem">
              <a class="footer-link-connect w-inline-block" href="https://plus.google.com/105753392254543335997" target="_blank">
                <img src="../_static/images/f-logo-google.png" width="23">
              </a>
            </li>
            <li class="footer-listitem">
              <a class="footer-link-connect w-inline-block" href="https://www.linkedin.com/company/crateio" target="_blank">
                <img src="../_static/images/f-logo-linkedin.png" width="22">
              </a>
            </li>
            <li class="footer-listitem">
              <a class="footer-link-connect w-inline-block" href="https://www.youtube.com/channel/UCcp_IqjXaejmwBcwg51n1AA" target="_blank">
                <img src="../_static/images/f-logo-youtube.png" width="24">
              </a>
            </li>
            <li class="footer-listitem">
              <a class="footer-link-connect w-inline-block" href="https://github.com/crate">
                <img src="../_static/images/f-logo-github.png" width="22">
              </a>
            </li>
            <div class="mobileHoriztonalMenu">
              <li class="footer-listitem-new"><a href="https://crate.io/contact/">Contact</a></li>
              <li class="footer-listitem-new"><a href="https://crate.io/legal/">Legal</a></li>
              <li class="footer-listitem-new"><a href="https://crate.io/legal/imprint/">Imprint</a></li>
            </div>
            <li class="footer-listitem link-list">
              <a class="footer-link-eu w-inline-block" href="/erdf/">
                <img class="logo-eu" sizes="100px" src="../_static/images/logo-eu-optimized-1.jpg" width="101">
              </a>
            </li>
          </ul>
        </div>
      </div>
      <div class="w-row">
        <a class="brand footer-brand w-inline-block" href="/">
          <img src="../_static/images/logo-crate.png" width="217">
        </a>
      </div>
    </div>
  </div>
</footer>

  <script>
  var $navAffix = $('#nav-affix');
  var $contentEl = $('.wrapper-content-right');
  // Desktop only
  if( !$('#mobile-menu-toggler').is(':visible') ) {

    // Only if the content is taller than the sidebar,
    // to avoid scroll jerk
    if ( $contentEl.height() > $navAffix.height() ) {
      // Init
      $navAffix.affix({
        offset: {
          top: 100,
          bottom: function () {
            return (this.bottom = $('footer').outerHeight(true) + 200)
          }
        }
      });
      // Recalculate the sidebar
      $(window).resize(function() {
        $navAffix.affix('checkPosition');
      });
    }

    $('body').scrollspy();

  } else {

    $('.wrapper-navleft').hide();
    $('#mobile-menu-toggler').click(function() {
      $('.wrapper-navleft').toggle();
    });

  }

  $(document).ready(function() {
    window.setTimeout(function() {$('body').append('<a href="https://crate.io/docs/support/slackin/" style="z-index: 10; position: fixed; bottom: 20px; right: ' + ($('#intercom-launcher').is(':visible') ? '90' : '20') + 'px; box-shadow: 0 6px 13px 0 rgba(0, 0, 0, .23)"><img src="../_static/images/slack.png" id="slack-container" /></a>'); }, 2000);
  });
  </script>

  <!-- Segment -->
  <script>
    !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","setAnonymousId"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="4.0.0";
      analytics.load("FToR4cE5lXyQziQirvt0kSnFQj0rAgu9");
      analytics.setAnonymousId($.cookie('uid'));
      analytics.page();
      analytics.track('visited_section_docs', {
        project: 'crate',
        version: ''
      });
    }}();
  </script>
  </body>
</html>